{% extends 'base.html.twig' %}

{% block title %}
    {{ parent() }} | Accueil
{% endblock %}

{% block body %}

    {{ form_start(filterForm) }}
    {{ form_widget(filterForm) }}
    <button>Rechercher</button>
    {{ form_end(filterForm) }}


{#    <form action="{{ path('main_search') }}" method="GET">#}
{#        <label for="campus">Campus</label>#}
{#        <select id="campus" name="campus">#}
{#            {% for campus in  listCampus %}#}
{#                <option value="{{ campus.name }}">#}
{#                    {{ campus.name }}#}
{#                </option>#}
{#            {% endfor %}#}
{#        </select>#}

{#        <label for="search">Le nom de la sortie contient :</label>#}
{#        <input type="text" id="search" name="search"><br>#}

{#        <label for="dateStar">Entre</label>#}
{#        <input type="datetime-local" id="dateStart" name="dateStart"><br>#}

{#        <label for="dateEnd">Et :</label>#}
{#        <input type="datetime-local" id="dateEnd" name="dateEnd"><br>#}

{#        <label for="eventManage">Sorties dont je suis l'organisateur/trice</label>#}
{#        <input type="checkbox" id="eventManage" name="eventManage"><br>#}

{#        <label for="eventIns">Sorties auquelles je suis inscrit/e</label>#}
{#        <input type="checkbox" id="eventIns" name="eventIns" checked><br>#}

{#        <label for="eventUnIns">Sorties dont je ne suis pas inscrit/e</label>#}
{#        <input type="checkbox" id="eventUnIns" name="eventUnIns" checked><br>#}

{#        <label for="eventOld">Sorties passée</label>#}
{#        <input type="checkbox" id="eventOld" name="eventOld" onclick="selectDate()" ><br>#}

{#        <input type="submit">#}
{#    </form>#}

    <a href="{{ path('event_create',{'id': app.user.id}) }}">Créer une sortie</a>

{% endblock %}

 {% block event %}
     <div class="main__card">
         {% for event in listEvent %}
             <div class="card">
                 {% set insc = '0' %}
                 {% set orga = '0' %}
                 {% for usr in event.users %}
                     {% if usr.id == app.user.id %}
                         {% set insc = '1' %}
                     {% endif %}
                 {% endfor %}
                 {% if event.organisator.id == app.user.id %}
                     {% set orga = '1' %}
                 {% endif %}
                     <div class="card__header">
                         <div class="card__nav">
                             <h4 class="card__title">
                                 {{ event.name }}
                             </h4>
                             <p class="card__state">
                                 {{event.state.label}}
                             </p>
                         </div>

                     </div>
                     <div class="card__main">
                         <div class="card__date">
                             <div class="card__date-days">
                                 <p class="card__text">date de début de l'événement</p>
                                 <p class="card__text">{{event.dateStart | date('d/m/y h:i')}}</p>
                             </div>
                             <div class="card__date-days">
                                 <p class="card__text">clôture</p>
                                 <p>{{(event.dateStart) | date_modify('+' ~ event.duration ~' minutes')| date('d/m/y h:i')}}</p>
                             </div>
                             <div class="card__registered">
                                 <p class="card__text">inscrit</p>
                                 {% if insc == '1' %}
                                     x
                                 {% endif %}
                             </div>
                         </div>
                         <div class="card__owner-participant">
                             <div class="card__owner">
                                 <p class="card__text">organisateur</p>
                                 <a class="card__link" href="{{ path('user_detail', {'id': event.organisator.id }) }}"> {{event.organisator.username}}</a>
                             </div>
                             <div class="card__number-participant">
                                 <p class="card__text">inscrits/places {{event.nbMaxInscription}}</p>
                             </div>
                         </div>
                         <div class="card__action">

                             <a class="card__link" href="{{ path('event_detail' , {'id': event.id }) }}">Afficher</a>
                             {% if orga == '1' %}
                                 <a class="card__link" href="{{ path('event_update' , {'id': event.id }) }}">Modifier</a>
                                 <a class="card__link" href="{{ path('event_delete' , {'id': event.id }) }}">Supprimer</a>
                             {% endif %}
                         </div>
                     </div>
                     <div class="card__footer">
                         {% if insc == '1' %}
                             <a class="card__link" href="{{ path('event_desinscription' , {'id': event.id }) }}">Se désister</a>
                         {% else %}
                             <a class="card__link" href="{{ path('event_inscription' , {'id': event.id }) }}">S'inscrire</a>
                         {% endif %}
                     </div>
             </div>
         {% else %}
             <p>pas de sorties</p>
         {% endfor %}
     </div>
 {% endblock %}
